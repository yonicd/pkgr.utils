---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# pkgr.utils

<!-- badges: start -->
<!-- badges: end -->

The goal of `pkgr.utils` is to control `pkgr` with utility functions from within `R`.

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(pkgr.utils)
```

### Command line builders

add/remove packages to `pkgr.yml`

```{r}
pkgs <- c('dplyr','ggplot2')

pkgs%>%
  pkgr.add()

pkgs%>%
  pkgr.add(config='pkgr.yml')

pkgs%>%
  pkgr.add(config='pkgr.yml',flags='install')

pkgs[1]%>%
  pkgr.remove()
```

plan/install

```{r}
# basic
pkgr.plan()
pkgr.install()


# with options
pkgr.install(config='pkgr.yml',library=.libPaths()[1])

# using pkgr.here function
pkgr.install(config=pkgr.here(),library=.libPaths()[1])

```

### Convert DESCRIPTION file to pkgr.yml

#### Local

```{r}
pkgr.utils::desc2pkgr()
```

#### URL

```{r}
sinew_uri <- 'https://raw.githubusercontent.com/metrumresearchgroup/sinew/master/DESCRIPTION'
sinew_pkgr <- pkgr.utils::desc2pkgr(sinew_uri)
```

### Convert pkgSetup.R file to pkgr.yml

```{r}
pkgr.utils::pkgSetup2pkgr(pkgsetup = system.file('pkgSetup.R',package = 'pkgr.utils'))
```

### Find difference in packages listed in DESCRIPTION/pkgSetup and pkgr.yml

#### pkgSetup.R

```{r}
tf <- tempfile(fileext = '.yml')
pkgr.utils::desc2pkgr(out = tf)

pkgr.utils::pkgr.diff(src = system.file('pkgSetup.R',package = 'pkgr.utils'),pkgr = tf)
```

#### DESCRIPTION

```{r}
tf_desc <- tempfile(pattern = 'DESCRIPTION')
utils::download.file(sinew_uri, destfile = tf_desc, quiet = TRUE)

readLines(tf_desc)
```

```{r}
pkgr.utils::pkgr.diff(src = tf_desc,pkgr = tf)
```
